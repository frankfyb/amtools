# AI工具导航首页 - 开发指南

## 1. 开发环境配置

### 1.1 系统要求
- **Node.js:** 18.0.0 或更高版本
- **npm:** 9.0.0 或更高版本
- **Git:** 2.30.0 或更高版本
- **编辑器:** VS Code (推荐) 或其他支持TypeScript的编辑器

### 1.2 项目初始化
```bash
# 克隆项目
git clone <repository-url>
cd amtool

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 启动生产服务器
npm start
```

### 1.3 开发工具配置
**VS Code 推荐插件：**
- ES7+ React/Redux/React-Native snippets
- Tailwind CSS IntelliSense
- TypeScript Importer
- Prettier - Code formatter
- ESLint
- Auto Rename Tag

**VS Code 设置：**
```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.preferences.importModuleSpecifier": "relative"
}
```

## 2. 技术栈详解

### 2.1 核心技术栈
- **Next.js 14+:** React全栈框架，提供SSR、路由、优化等功能
- **React 18+:** 用户界面库，支持并发特性和新的Hooks
- **TypeScript:** 类型安全的JavaScript超集
- **Tailwind CSS:** 实用优先的CSS框架

### 2.2 开发依赖
- **ESLint:** 代码质量检查工具
- **Prettier:** 代码格式化工具
- **PostCSS:** CSS处理工具
- **Autoprefixer:** CSS前缀自动添加

### 2.3 技术选型理由
**Next.js 选择原因：**
- 优秀的开发体验和性能优化
- 内置的图片优化和代码分割
- 强大的路由系统和API支持
- 良好的SEO支持

**Tailwind CSS 选择原因：**
- 快速的样式开发
- 一致的设计系统
- 优秀的响应式设计支持
- 小的生产包大小

## 3. 项目结构

### 3.1 目录结构
```
src/
├── app/                    # Next.js App Router
│   ├── globals.css        # 全局样式
│   ├── layout.tsx         # 根布局组件
│   ├── page.tsx          # 首页组件
│   └── tools/            # 工具页面
├── components/            # 可复用组件
├── lib/                  # 工具函数和配置
├── types/                # TypeScript类型定义
└── hooks/                # 自定义React Hooks
```

### 3.2 文件命名规范
- **组件文件：** PascalCase (如 `ToolCard.tsx`)
- **页面文件：** kebab-case (如 `page.tsx`)
- **工具函数：** camelCase (如 `formatDate.ts`)
- **类型文件：** PascalCase (如 `Tool.types.ts`)
- **常量文件：** UPPER_SNAKE_CASE (如 `API_ENDPOINTS.ts`)

### 3.3 导入顺序规范
```typescript
// 1. React相关导入
import React, { useState, useEffect } from 'react';

// 2. 第三方库导入
import clsx from 'clsx';

// 3. 内部组件导入
import { ToolCard } from '@/components/ToolCard';

// 4. 类型导入
import type { Tool, Category } from '@/types';

// 5. 相对路径导入
import './styles.css';
```

## 4. 开发规范

### 4.1 代码风格规范
**TypeScript 规范：**
```typescript
// 使用接口定义对象类型
interface Tool {
  id: string;
  name: string;
  description: string;
}

// 使用类型别名定义联合类型
type Status = 'loading' | 'success' | 'error';

// 组件Props类型定义
interface ToolCardProps {
  tool: Tool;
  onClick?: (tool: Tool) => void;
}

// 函数组件定义
export function ToolCard({ tool, onClick }: ToolCardProps) {
  // 组件逻辑
}
```

**React Hooks 规范：**
```typescript
// 状态管理
const [tools, setTools] = useState<Tool[]>([]);
const [loading, setLoading] = useState(true);

// 副作用处理
useEffect(() => {
  // 清理函数
  return () => {
    // 清理逻辑
  };
}, [dependency]);

// 自定义Hook
function useTools() {
  const [tools, setTools] = useState<Tool[]>([]);
  
  // Hook逻辑
  
  return { tools, setTools };
}
```

### 4.2 组件开发规范
**组件结构：**
```typescript
'use client';

import { useState, useEffect } from 'react';
import type { ComponentProps } from './types';

interface Props extends ComponentProps {
  // 组件特定的props
}

export function ComponentName({ ...props }: Props) {
  // 1. Hooks声明
  const [state, setState] = useState();
  
  // 2. 副作用处理
  useEffect(() => {
    // 副作用逻辑
  }, []);
  
  // 3. 事件处理函数
  const handleClick = () => {
    // 处理逻辑
  };
  
  // 4. 渲染逻辑
  return (
    <div className="component-container">
      {/* JSX内容 */}
    </div>
  );
}
```

**组件命名规范：**
- 组件名使用PascalCase
- 文件名与组件名保持一致
- 导出使用具名导出，避免默认导出

### 4.3 样式开发规范
**Tailwind CSS 使用规范：**
```typescript
// 基础样式类
const baseClasses = "bg-white rounded-lg shadow-md p-6";

// 条件样式类
const conditionalClasses = clsx(
  baseClasses,
  {
    'border-blue-500': isActive,
    'opacity-50': isDisabled,
  }
);

// 响应式样式
const responsiveClasses = "text-sm sm:text-base lg:text-lg";

// 状态样式
const stateClasses = "hover:shadow-lg transition-shadow duration-300";
```

**自定义CSS规范：**
```css
/* 使用CSS变量 */
:root {
  --primary-color: #3b82f6;
  --secondary-color: #64748b;
}

/* BEM命名规范 */
.tool-card {
  /* 块级样式 */
}

.tool-card__header {
  /* 元素样式 */
}

.tool-card--featured {
  /* 修饰符样式 */
}
```

## 5. 性能优化指南

### 5.1 React性能优化
**组件优化：**
```typescript
// 使用React.memo优化组件
export const ToolCard = React.memo(function ToolCard({ tool }: Props) {
  return <div>{/* 组件内容 */}</div>;
});

// 使用useMemo优化计算
const filteredTools = useMemo(() => {
  return tools.filter(tool => tool.category === selectedCategory);
}, [tools, selectedCategory]);

// 使用useCallback优化函数
const handleToolClick = useCallback((tool: Tool) => {
  // 处理逻辑
}, []);
```

**状态管理优化：**
```typescript
// 避免不必要的状态更新
const [tools, setTools] = useState<Tool[]>([]);

// 使用函数式更新
setTools(prevTools => [...prevTools, newTool]);

// 合理拆分状态
const [loading, setLoading] = useState(false);
const [error, setError] = useState<string | null>(null);
```

### 5.2 加载性能优化
**图片优化：**
```typescript
import Image from 'next/image';

// 使用Next.js Image组件
<Image
  src="/tool-icon.png"
  alt="Tool Icon"
  width={48}
  height={48}
  priority={isAboveFold}
  placeholder="blur"
  blurDataURL="data:image/jpeg;base64,..."
/>
```

**代码分割：**
```typescript
// 动态导入组件
const LazyComponent = dynamic(() => import('./LazyComponent'), {
  loading: () => <div>Loading...</div>,
  ssr: false
});

// 条件加载
if (shouldLoadComponent) {
  const Component = await import('./Component');
}
```

### 5.3 渲染性能优化
**虚拟化长列表：**
```typescript
// 对于大量数据，考虑使用虚拟化
import { FixedSizeList as List } from 'react-window';

function VirtualizedToolList({ tools }: Props) {
  return (
    <List
      height={600}
      itemCount={tools.length}
      itemSize={200}
    >
      {({ index, style }) => (
        <div style={style}>
          <ToolCard tool={tools[index]} />
        </div>
      )}
    </List>
  );
}
```

## 6. 测试策略

### 6.1 单元测试
```typescript
// 组件测试示例
import { render, screen } from '@testing-library/react';
import { ToolCard } from './ToolCard';

describe('ToolCard', () => {
  const mockTool = {
    id: '1',
    name: 'Test Tool',
    description: 'Test Description',
    // ...其他属性
  };

  it('renders tool information correctly', () => {
    render(<ToolCard tool={mockTool} />);
    
    expect(screen.getByText('Test Tool')).toBeInTheDocument();
    expect(screen.getByText('Test Description')).toBeInTheDocument();
  });
});
```

### 6.2 集成测试
```typescript
// 页面测试示例
import { render, screen, fireEvent } from '@testing-library/react';
import Home from './page';

describe('Home Page', () => {
  it('filters tools by category', async () => {
    render(<Home />);
    
    // 点击分类按钮
    fireEvent.click(screen.getByText('AI写作'));
    
    // 验证筛选结果
    expect(screen.getByText('ChatGPT')).toBeInTheDocument();
  });
});
```

### 6.3 E2E测试
```typescript
// Playwright测试示例
import { test, expect } from '@playwright/test';

test('user can browse and filter tools', async ({ page }) => {
  await page.goto('/');
  
  // 验证页面加载
  await expect(page.locator('h1')).toContainText('AI工具导航');
  
  // 测试分类筛选
  await page.click('text=AI写作');
  await expect(page.locator('.tool-card')).toHaveCount(2);
});
```

## 7. 调试和故障排除

### 7.1 常见问题解决
**Hydration错误：**
```typescript
// 避免服务端和客户端渲染不一致
const [mounted, setMounted] = useState(false);

useEffect(() => {
  setMounted(true);
}, []);

if (!mounted) {
  return null; // 或者返回占位符
}
```

**性能问题调试：**
```typescript
// 使用React DevTools Profiler
// 使用console.time测量性能
console.time('filter-tools');
const filtered = tools.filter(/* 筛选逻辑 */);
console.timeEnd('filter-tools');
```

### 7.2 开发工具使用
**React DevTools：**
- 组件树查看和调试
- Props和State检查
- 性能分析

**浏览器开发者工具：**
- Network面板监控请求
- Performance面板分析性能
- Console面板查看日志

## 8. 部署和发布

### 8.1 构建优化
```bash
# 生产构建
npm run build

# 分析包大小
npm run analyze

# 类型检查
npm run type-check

# 代码检查
npm run lint
```

### 8.2 环境配置
```typescript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    appDir: true,
  },
  images: {
    domains: ['example.com'],
  },
  env: {
    CUSTOM_KEY: process.env.CUSTOM_KEY,
  },
};

module.exports = nextConfig;
```

### 8.3 性能监控
```typescript
// 添加性能监控
export function reportWebVitals(metric) {
  console.log(metric);
  // 发送到分析服务
}
```

## 9. 最佳实践总结

### 9.1 代码质量
- 保持组件单一职责
- 使用TypeScript确保类型安全
- 编写有意义的注释
- 遵循一致的代码风格

### 9.2 性能优化
- 合理使用React优化技术
- 实施代码分割和懒加载
- 优化图片和资源加载
- 监控和分析性能指标

### 9.3 用户体验
- 提供加载状态反馈
- 实现优雅的错误处理
- 确保无障碍访问
- 优化移动端体验

### 9.4 可维护性
- 保持清晰的项目结构
- 编写全面的测试
- 建立完善的文档
- 实施持续集成和部署

## 10. 学习资源

### 10.1 官方文档
- [Next.js Documentation](https://nextjs.org/docs)
- [React Documentation](https://react.dev)
- [TypeScript Handbook](https://www.typescriptlang.org/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)

### 10.2 推荐阅读
- React性能优化指南
- Next.js最佳实践
- TypeScript进阶技巧
- 现代CSS布局技术

### 10.3 工具和插件
- React DevTools
- Next.js Bundle Analyzer
- Lighthouse性能分析
- Vercel部署平台