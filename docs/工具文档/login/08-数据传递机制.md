# 数据传递机制（Props、Context 与 URL）

## 学习目标
- 掌握组件间数据传递方式：Props、Context、服务层与 URL 查询参数。

## 传递方式
- Props：父传子最直接方式；适合简单层级与局部数据。
- Context：跨层级共享数据；本项目用 `SessionProvider` 提供会话。
- 服务层：将逻辑从组件抽离到工具函数，减少 props 嵌套与重复代码。
- URL 查询参数：跨页面传递轻量指令（如回跳地址与提示标志）。

## 本项目的实践
- `AuthStatus` 通过 Context 获取会话，并使用服务层工具拼接显示名、解析提示。
- 登录页通过 URL 的 `callbackUrl`/`from` 确定回跳；成功后附带 `login=ok`。

## 示例
- 上下文获取会话：
```tsx
import { useSession } from 'next-auth/react';
const { data: session } = useSession();
const displayName = session?.user?.name || session?.user?.email || '用户';
```

- 通过 URL 传递回跳与提示：
```ts
const url = new URL('/login', window.location.origin);
url.searchParams.set('from', window.location.pathname);
// 登录成功后在组件里解析参数并展示提示
```

## 取舍建议
- 优先用 Context 与服务层传递关键数据；URL 仅传轻量指令。
- URL 参数需校验与清理，避免污染地址栏与历史记录。