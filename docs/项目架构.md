# AMTool 项目架构文档

## 项目概述

AMTool 是一个现代化的在线工具集合平台，基于 Next.js 15 和 React 19 构建，采用最新的 Web 技术栈，提供高性能、可扩展的工具服务。

## 技术架构

### 核心技术栈

#### 前端框架
- **Next.js 15**: 
  - 采用 App Router 架构
  - 支持 Server Components 和 Client Components
  - 内置性能优化和 SEO 支持
  - Turbopack 构建工具提升开发体验

- **React 19**:
  - 最新版本的 React
  - 支持并发特性和 Suspense
  - 优化的渲染性能
  - 改进的开发者体验

#### 开发语言
- **TypeScript**:
  - 类型安全的 JavaScript 超集
  - 编译时错误检查
  - 智能代码提示和重构
  - 严格模式配置确保代码质量

#### 样式系统
- **Tailwind CSS 4**:
  - 原子化 CSS 框架
  - 响应式设计支持
  - 自定义主题配置
  - 生产环境自动优化

#### 构建工具
- **Turbopack**:
  - Next.js 15 默认构建工具
  - 比 Webpack 更快的构建速度
  - 增量编译和热重载
  - 优化的开发体验

### 架构模式

#### 1. App Router 架构
```
src/app/
├── layout.tsx          # 根布局 (Server Component)
├── page.tsx           # 首页 (Server Component)
├── globals.css        # 全局样式
└── tools/             # 工具路由组
    └── [tool-name]/   # 动态工具路由
        └── page.tsx   # 工具页面
```

**特点**:
- 基于文件系统的路由
- 支持嵌套布局
- 自动代码分割
- SEO 友好的服务端渲染

#### 2. 组件化架构（规划中）
```
src/
├── components/
│   ├── ui/            # 基础 UI 组件
│   ├── layout/        # 布局组件
│   └── tools/         # 工具专用组件
├── lib/               # 工具库
├── hooks/             # 自定义 Hooks
└── types/             # 类型定义
```

**设计原则**:
- 单一职责原则
- 可复用性
- 类型安全
- 性能优化

#### 3. 工具模块架构
每个工具采用独立模块设计：

```
tools/[tool-name]/
├── page.tsx           # 工具页面组件
├── components/        # 工具专用组件
├── hooks/             # 工具专用 Hooks
├── utils/             # 工具逻辑函数
└── types.ts           # 工具类型定义
```

## 性能优化策略

### 1. 构建优化
- **Turbopack**: 快速构建和热重载
- **代码分割**: 自动按路由分割代码
- **Tree Shaking**: 移除未使用的代码
- **压缩优化**: 生产环境自动压缩

### 2. 图片优化
```typescript
// next.config.ts
const nextConfig = {
  images: {
    formats: ['image/webp', 'image/avif'],
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840]
  }
}
```

### 3. 缓存策略
- **静态生成**: 构建时预渲染页面
- **增量静态再生**: 按需更新静态内容
- **客户端缓存**: 浏览器缓存优化

### 4. 运行时优化
- **React 19 并发特性**: 优化渲染性能
- **Suspense**: 改善加载体验
- **懒加载**: 按需加载组件和资源

## 开发工具链

### 代码质量
- **ESLint**: 代码规范检查
- **TypeScript**: 类型检查
- **Prettier**: 代码格式化（规划中）

### 开发环境
- **VS Code**: 推荐编辑器
- **扩展配置**: 自动化开发体验
- **调试配置**: 断点调试支持

### 测试框架（规划中）
- **Jest**: 单元测试
- **React Testing Library**: 组件测试
- **Playwright**: 端到端测试

## 部署架构

### Vercel 部署
```json
{
  "buildCommand": "npm run build",
  "outputDirectory": ".next",
  "installCommand": "npm install",
  "framework": "nextjs"
}
```

**特点**:
- 全球 CDN 分发
- 自动 HTTPS
- 边缘函数支持
- 性能监控

### CI/CD 流程
```yaml
# .github/workflows/deploy.yml
name: Deploy
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npm ci
      - run: npm run build
      - run: npm run test
```

## 安全策略

### 1. 内容安全策略
```typescript
// next.config.ts
const securityHeaders = [
  {
    key: 'X-DNS-Prefetch-Control',
    value: 'on'
  },
  {
    key: 'Strict-Transport-Security',
    value: 'max-age=63072000; includeSubDomains; preload'
  },
  {
    key: 'X-XSS-Protection',
    value: '1; mode=block'
  }
]
```

### 2. 数据安全
- 客户端数据处理
- 无服务端数据存储
- 本地存储加密（规划中）

## 可扩展性设计

### 1. 工具插件化
```typescript
interface ToolConfig {
  name: string;
  path: string;
  category: string;
  description: string;
  component: React.ComponentType;
}
```

### 2. 主题系统（规划中）
```typescript
interface ThemeConfig {
  colors: ColorPalette;
  typography: TypographyScale;
  spacing: SpacingScale;
  breakpoints: Breakpoints;
}
```

### 3. 国际化支持（规划中）
```typescript
interface I18nConfig {
  locales: string[];
  defaultLocale: string;
  messages: Record<string, Record<string, string>>;
}
```

## 监控和分析

### 性能监控
- **Lighthouse**: 性能评分
- **Web Vitals**: 核心性能指标
- **Bundle Analyzer**: 包大小分析

### 错误监控（规划中）
- **Sentry**: 错误追踪
- **日志系统**: 运行时日志
- **用户反馈**: 问题收集

## 开发规范

### 1. 代码规范
```typescript
// 组件命名：PascalCase
export default function PasswordGenerator() {}

// 函数命名：camelCase
export function generatePassword() {}

// 常量命名：UPPER_SNAKE_CASE
export const DEFAULT_PASSWORD_LENGTH = 12;
```

### 2. 文件组织
```
- 页面文件：kebab-case (password-generator/page.tsx)
- 组件文件：PascalCase (PasswordGenerator.tsx)
- 工具函数：camelCase (generatePassword.ts)
- 类型文件：PascalCase (PasswordTypes.ts)
```

### 3. 提交规范
```
feat: 新功能
fix: 修复问题
docs: 文档更新
style: 代码格式
refactor: 重构
test: 测试相关
chore: 构建工具
```

## 技术债务管理

### 当前技术债务
1. 缺少组件库系统
2. 缺少测试覆盖
3. 缺少错误边界处理
4. 缺少性能监控

### 优化计划
1. **Q1**: 建立组件库和设计系统
2. **Q2**: 完善测试框架和覆盖率
3. **Q3**: 集成监控和分析系统
4. **Q4**: 性能优化和用户体验提升

## 总结

AMTool 项目采用现代化的技术架构，具备以下优势：

1. **高性能**: Next.js 15 + React 19 + Turbopack
2. **类型安全**: TypeScript 严格模式
3. **开发体验**: 热重载 + 智能提示
4. **可维护性**: 模块化架构 + 代码规范
5. **可扩展性**: 插件化设计 + 配置驱动
6. **部署简单**: Vercel 一键部署
7. **性能监控**: Lighthouse + Web Vitals

项目架构为未来的功能扩展和性能优化奠定了坚实的基础。